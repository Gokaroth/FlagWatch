:root {
  /* Primitive Color Tokens */
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-100: #f8f9fa;
  --color-gray-200: #e9ecef;
  --color-gray-300: #dee2e6;
  --color-gray-400: #ced4da;
  --color-gray-500: #adb5bd;
  --color-gray-600: #6c757d;
  --color-gray-700: #495057;
  --color-gray-800: #343a40;
  --color-gray-900: #212529;

  /* Semantic Color Tokens */
  --color-primary: #007bff;
  --color-primary-hover: #0056b3;
  --color-secondary: #6c757d;
  --color-success: #28a745;
  --color-danger: #dc3545;
  --color-warning: #ffc107;
  --color-info: #17a2b8;

  /* Light Theme Defaults */
  --color-background: var(--color-gray-100);
  --color-text: var(--color-gray-800);
  --color-text-light: var(--color-gray-600);
  --color-border: var(--color-gray-300);
  --color-surface: var(--color-white);
  --color-shadow: rgba(0, 0, 0, 0.1);

  /* Sizing & Spacing */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;

  /* Typography */
  --font-family-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  --font-size-sm: 0.875rem; /* 14px */
  --font-size-md: 1rem; /* 16px */
  --font-size-lg: 1.25rem; /* 20px */
  --font-size-xl: 1.5rem; /* 24px */
  --font-weight-normal: 400;
  --font-weight-bold: 700;

  /* Borders & Shadows */
  --border-radius-sm: 4px;
  --border-radius-md: 8px;
  --border-radius-lg: 16px;
  --box-shadow-sm: 0 1px 3px var(--color-shadow);
  --box-shadow-md: 0 4px 6px var(--color-shadow);
  --box-shadow-lg: 0 10px 15px var(--color-shadow);
  
  /* Transitions */
  --transition-fast: 0.15s ease-in-out;
  --transition-base: 0.3s ease-in-out;
}

/* Dark Theme Variables */
body.dark-mode {
  --color-primary: #4dabf7;
  --color-primary-hover: #74c0fc;
  --color-secondary: #868e96;
  --color-success: #40c057;
  --color-danger: #fa5252;
  --color-warning: #fcc419;
  --color-info: #3bc9db;

  --color-background: #1a1b1e;
  --color-text: #e9ecef;
  --color-text-light: #adb5bd;
  --color-border: #495057;
  --color-surface: #2c2e33;
  --color-shadow: rgba(0, 0, 0, 0.5);
}

/* Global Styles & Resets */
*, *::before, *::after {
  box-sizing: border-box;
}

html {
  -webkit-tap-highlight-color: transparent;
}

body {
  margin: 0;
  font-family: var(--font-family-sans);
  font-size: var(--font-size-md);
  color: var(--color-text);
  background-color: var(--color-background);
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  overflow: hidden; /* Prevent body scroll */
  transition: background-color var(--transition-base), color var(--transition-base);
}

/* Utility Classes */
.hidden {
  display: none !important;
}

/* Loading Screen */
.loading-screen {
  position: fixed;
  inset: 0;
  background-color: var(--color-primary);
  color: var(--color-white);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}
body.dark-mode .loading-screen {
    background-color: #1a1b1e;
}

.loading-content { text-align: center; }
.loading-icon { font-size: 3rem; animation: bounce 2s infinite; }
.loading-spinner {
  width: 40px; height: 40px; border: 4px solid rgba(255, 255, 255, 0.3);
  border-top-color: var(--color-white); border-radius: 50%;
  animation: spin 1s linear infinite; margin: var(--spacing-lg) auto 0;
}
body.dark-mode .loading-spinner { border-top-color: var(--color-primary); }

@keyframes spin { to { transform: rotate(360deg); } }
@keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-30px); } 60% { transform: translateY(-15px); } }

/* Main App Layout */
.app { display: flex; flex-direction: column; height: 100vh; }
.sidebar { display: none; } /* Hide sidebar on mobile by default */
.header { background-color: var(--color-surface); border-bottom: 1px solid var(--color-border); padding: var(--spacing-sm) var(--spacing-md); box-shadow: var(--box-shadow-sm); z-index: 100; }
.header-content { display: flex; justify-content: space-between; align-items: center; }
.header-title { margin: 0; font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: var(--color-primary); }
.header-controls { display: flex; gap: var(--spacing-sm); }
.nav-tabs { display: flex; background-color: var(--color-surface); border-bottom: 1px solid var(--color-border); }
.nav-tab { flex: 1; padding: var(--spacing-sm) var(--spacing-md); text-align: center; cursor: pointer; border: none; background: none; font-size: var(--font-size-md); color: var(--color-text-light); border-bottom: 3px solid transparent; transition: all var(--transition-fast); }
.nav-tab.active { color: var(--color-primary); border-bottom-color: var(--color-primary); font-weight: var(--font-weight-bold); }
.search-container-mobile { padding: var(--spacing-md); background: var(--color-surface); border-bottom: 1px solid var(--color-border); display: none; }
.filter-controls-container { padding-top: var(--spacing-md); }
.filter-controls { display: flex; gap: var(--spacing-sm); justify-content: center; flex-wrap: wrap; }
.main-content { flex: 1; display: flex; flex-direction: column; position: relative; overflow: hidden; }
.view { display: none; }
.view.active { display: flex; flex-direction: column; flex-grow: 1; }

/* Map View */
#map-view { position: relative; }
.map-container { flex-grow: 1; width: 100%; background-color: #aaa; }
body.dark-mode .map-container { filter: invert(1) hue-rotate(180deg) brightness(0.8) contrast(1.2); }
.map-controls { position: absolute; bottom: var(--spacing-lg); right: var(--spacing-md); z-index: 401; }
.map-control-btn { border-radius: 50%; width: 50px; height: 50px; font-size: 1.5rem; box-shadow: var(--box-shadow-md); }

/* List View */
#list-view { overflow-y: auto; }
.beach-list { padding: var(--spacing-sm); }
.beach-item { background-color: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--border-radius-md); padding: var(--spacing-md); margin-bottom: var(--spacing-sm); cursor: pointer; transition: box-shadow var(--transition-fast), border-color var(--transition-fast); }
.beach-item:hover { box-shadow: var(--box-shadow-md); border-color: var(--color-primary); }
.beach-item-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--spacing-sm); }
.beach-name { margin: 0; font-size: var(--font-size-lg); }
.beach-name-bg { color: var(--color-text-light); font-size: var(--font-size-sm); }
.beach-info { display: flex; justify-content: space-between; align-items: center; font-size: var(--font-size-sm); }
.facility-icon { font-size: 1.2rem; margin-right: var(--spacing-xs); }
.beach-distance { font-weight: var(--font-weight-bold); color: var(--color-primary); }
.no-results p { text-align: center; color: var(--color-text-light); padding: var(--spacing-xl); }


/* Modals */
.modal { position: fixed; inset: 0; display: flex; justify-content: center; align-items: center; z-index: 500; }
.modal-backdrop { position: absolute; inset: 0; background-color: rgba(0, 0, 0, 0.6); }
body.dark-mode .modal-backdrop { background-color: rgba(0, 0, 0, 0.8); }
.modal-content { background-color: var(--color-surface); border-radius: var(--border-radius-lg); box-shadow: var(--box-shadow-lg); width: 90%; max-width: 500px; max-height: 90vh; display: flex; flex-direction: column; z-index: 1; animation: slideInUp 0.3s; }
.modal-header { display: flex; justify-content: space-between; align-items: center; padding: var(--spacing-md); border-bottom: 1px solid var(--color-border); }
.modal-title { margin: 0; font-size: var(--font-size-lg); }
.modal-close { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--color-text-light); }
.modal-body { padding: var(--spacing-md); overflow-y: auto; }
.modal-footer { padding: var(--spacing-md); border-top: 1px solid var(--color-border); text-align: right; }
@keyframes slideInUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

/* Beach Detail Modal specific styles */
.flag-indicator { font-weight: var(--font-weight-bold); font-size: 1.1rem; text-align: center; margin-bottom: var(--spacing-md); }
.flag-indicator.green { color: var(--color-success); }
.flag-indicator.yellow { color: var(--color-warning); }
.flag-indicator.red { color: var(--color-danger); }

.conditions-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: var(--spacing-md); margin-bottom: var(--spacing-md); text-align: center; }
.condition-label { font-size: var(--font-size-sm); color: var(--color-text-light); }
.condition-value { font-weight: var(--font-weight-bold); font-size: 1.1rem; }
.safety-message { margin: var(--spacing-md) 0; padding: var(--spacing-sm); background: var(--color-gray-100); border-radius: var(--border-radius-sm); }
body.dark-mode .safety-message { background-color: var(--color-background); }
.facilities-list { display: flex; flex-wrap: wrap; gap: var(--spacing-sm); margin-top: var(--spacing-sm); }
.facility-tag { background-color: var(--color-gray-200); padding: var(--spacing-xs) var(--spacing-sm); border-radius: var(--border-radius-sm); font-size: var(--font-size-sm); }
body.dark-mode .facility-tag { background-color: var(--color-gray-800); }
.last-updated { text-align: center; font-size: var(--font-size-sm); color: var(--color-text-light); margin-top: var(--spacing-md); }
.cleanliness-section { margin-top: var(--spacing-md); }
.cleanliness-status { font-weight: bold; text-align: center; margin-bottom: var(--spacing-sm); }
.cleanliness-status.clear { color: var(--color-info); }
.cleanliness-status.moderate { color: var(--color-warning); }
.cleanliness-status.high { color: var(--color-danger); }
.cleanliness-report-text { font-size: var(--font-size-sm); color: var(--color-text-light); }

/* Settings Modal specific styles */
.settings-section { margin-bottom: var(--spacing-lg); }
.settings-section h3 { margin-top: 0; border-bottom: 1px solid var(--color-border); padding-bottom: var(--spacing-sm); }
.legend-item { display: flex; align-items: center; margin-bottom: var(--spacing-sm); }
.flag-icon { font-size: 1.2rem; margin-right: var(--spacing-sm); }
#safety-tips-list { padding-left: var(--spacing-lg); }

/* Form Controls & Buttons */
.btn { display: inline-block; font-weight: var(--font-weight-bold); text-align: center; vertical-align: middle; cursor: pointer; user-select: none; background-color: transparent; border: 1px solid transparent; padding: 0.375rem 0.75rem; font-size: var(--font-size-md); border-radius: var(--border-radius-sm); transition: all var(--transition-fast); }
.btn--primary { color: var(--color-white); background-color: var(--color-primary); border-color: var(--color-primary); }
.btn--primary:hover { background-color: var(--color-primary-hover); border-color: var(--color-primary-hover); }
body.dark-mode .btn--primary { color: var(--color-black); }

.btn--secondary { color: var(--color-text); background-color: var(--color-gray-300); border-color: var(--color-gray-300); }
body.dark-mode .btn--secondary { color: var(--color-text); background-color: var(--color-gray-700); border-color: var(--color-gray-700); }

.btn--outline { color: var(--color-primary); border-color: var(--color-primary); }
.btn--outline:hover { color: var(--color-white); background-color: var(--color-primary); }
body.dark-mode .btn--outline:hover { color: var(--color-black); }


.btn--sm { padding: 0.25rem 0.5rem; font-size: var(--font-size-sm); }
.filter-btn { background-color: var(--color-gray-200); color: var(--color-text-light); }
body.dark-mode .filter-btn { background-color: var(--color-gray-800); color: var(--color-text-light); }
.filter-btn.active { background-color: var(--color-primary); color: var(--color-white); box-shadow: var(--box-shadow-sm); }
body.dark-mode .filter-btn.active { color: var(--color-black); }

.form-control { display: block; width: 100%; padding: 0.5rem 0.75rem; font-size: var(--font-size-md); line-height: 1.5; color: var(--color-text); background-color: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--border-radius-sm); transition: border-color var(--transition-fast), box-shadow var(--transition-fast); }
.form-control:focus { border-color: var(--color-primary); outline: 0; box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25); }
body.dark-mode .form-control:focus { box-shadow: 0 0 0 0.2rem rgba(77, 171, 247, 0.25); }


/* Custom Map Markers */
.custom-marker-icon { position: relative; display: flex; align-items: center; justify-content: center; }
.flag-emoji { font-size: 24px; text-shadow: 0px 0px 3px rgba(0,0,0,0.5); }
.cleanliness-dot { position: absolute; bottom: 5px; right: 0px; width: 10px; height: 10px; border-radius: 50%; border: 1.5px solid white; box-shadow: 0 0 3px rgba(0,0,0,0.5); }
.cleanliness-dot.clear { background-color: var(--color-info); }
.cleanliness-dot.moderate { background-color: var(--color-warning); }
.cleanliness-dot.high { background-color: var(--color-danger); }

.beach-popup h3 { margin: 0 0 5px; }
.beach-popup .flag-status { font-weight: bold; margin-bottom: 5px; }
.beach-popup .cleanliness-status-popup { font-size: 0.9em; margin-bottom: 10px; }
.beach-popup .cleanliness-status-popup.clear { color: var(--color-info); }
.beach-popup .cleanliness-status-popup.moderate { color: var(--color-warning); }
.beach-popup .cleanliness-status-popup.high { color: var(--color-danger); }
body.dark-mode .leaflet-popup-content-wrapper, body.dark-mode .leaflet-popup-tip { background: var(--color-surface); color: var(--color-text); }


.user-location-marker { font-size: 20px; }

/* Offline Indicator */
.offline-indicator { position: fixed; bottom: 0; left: 0; right: 0; background-color: var(--color-warning); color: var(--color-gray-800); text-align: center; padding: var(--spacing-sm); z-index: 1000; font-size: var(--font-size-sm); }

/* Theme Toggle Switch */
.theme-toggle-wrapper { display: flex; justify-content: space-between; align-items: center; }
.toggle-switch { position: relative; display: inline-block; width: 50px; height: 26px; }
.toggle-switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--color-gray-400); transition: .4s; border-radius: 26px; }
.slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
input:checked + .slider { background-color: var(--color-primary); }
input:focus + .slider { box-shadow: 0 0 1px var(--color-primary); }
input:checked + .slider:before { transform: translateX(24px); }


/* Responsiveness: Tablet and Desktop */
@media (min-width: 768px) {
  .app { flex-direction: row; height: 100vh; max-width: none; margin: 0; }
  .header, .nav-tabs, .search-container-mobile { display: none; }
  .sidebar { 
    display: flex; /* Show sidebar on desktop */
    width: 350px; 
    min-width: 300px; 
    max-width: 400px; 
    height: 100vh; 
    flex-direction: column; 
    border-right: 1px solid var(--color-border); 
    background: var(--color-surface); 
    z-index: 10; 
  }
  .sidebar-header { padding: var(--spacing-md); border-bottom: 1px solid var(--color-border); }
  .sidebar-search { padding: var(--spacing-md); border-bottom: 1px solid var(--color-border); }
  .beach-list-container { flex-grow: 1; overflow-y: auto; }
  .sidebar-footer { padding: var(--spacing-md); border-top: 1px solid var(--color-border); text-align: center; }
  .main-content { flex-grow: 1; height: 100vh; }
  #map-view, #list-view { height: 100%; }
  #map-view { display: flex; }
  #list-view { display: none; }
}